(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[355],{7615:function(e,a,t){Promise.resolve().then(t.bind(t,104))},104:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var s=t(7437),r=t(2265),n=t(2586),l=t(3227);async function i(){return(await l.ZP.get("/social/posts/")).data}async function o(e){return(await l.ZP.post("/social/posts/".concat(e,"/generate-pack/"))).data}async function c(e){return(await l.ZP.get("/social/posts/".concat(e,"/download-pack/"),{responseType:"blob"})).data}function d(){(0,n.useTranslations)();let[e,a]=(0,r.useState)([]),[t,l]=(0,r.useState)(!0),[d,h]=(0,r.useState)(null),[u,m]=(0,r.useState)(null),p=async()=>{try{l(!0);let e=await i();a(e)}catch(a){var e,t;console.error("Error loading posts:",a),h((null===(t=a.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.detail)||"Failed to load posts")}finally{l(!1)}};(0,r.useEffect)(()=>{p()},[]);let g=async e=>{try{m(e);let a=await o(e);alert("Pack generation started! Task ID: ".concat(a.task_id)),await p()}catch(e){var a,t;console.error("Error generating pack:",e),alert((null===(t=e.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.error)||"Failed to generate pack")}finally{m(null)}},x=async e=>{try{let a=await c(e),t=window.URL.createObjectURL(a),s=document.createElement("a");s.href=t,s.download="instagram_pack_".concat(e,".zip"),document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(t),document.body.removeChild(s)}catch(e){var a,t;console.error("Error downloading pack:",e),alert((null===(t=e.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.error)||"Failed to download pack")}},b=e=>{let a="px-3 py-1 rounded-full text-xs font-semibold";switch(e){case"draft":default:return"".concat(a," bg-gray-100 text-gray-800");case"ready":return"".concat(a," bg-blue-100 text-blue-800");case"published":return"".concat(a," bg-green-100 text-green-800");case"archived":return"".concat(a," bg-yellow-100 text-yellow-800")}};return t?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Instagram Management"}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:(0,s.jsx)("p",{className:"text-gray-600",children:"Loading posts..."})})]})}):d?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Instagram Management"}),(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[(0,s.jsx)("p",{className:"text-red-800 font-semibold",children:"Error loading posts"}),(0,s.jsx)("p",{className:"text-red-600 mt-2",children:d})]})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Instagram Management"}),(0,s.jsx)("p",{className:"text-gray-600 mt-1",children:"Manual Publish Pack Workflow"})]}),(0,s.jsx)("a",{href:"/admin/social/instagrampost/add/",className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"Create New Post"})]}),(0,s.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[(0,s.jsx)("h3",{className:"font-semibold text-blue-900 mb-2",children:"\uD83D\uDCF1 Manual Publish Workflow"}),(0,s.jsxs)("ol",{className:"text-sm text-blue-800 space-y-1 list-decimal list-inside",children:[(0,s.jsx)("li",{children:"Create post in Django Admin with caption and media from marketing bucket"}),(0,s.jsx)("li",{children:"Generate publish pack (ZIP file)"}),(0,s.jsx)("li",{children:"Download ZIP and extract files"}),(0,s.jsx)("li",{children:"Open Instagram app on your phone"}),(0,s.jsx)("li",{children:"Create new post with images from ZIP"}),(0,s.jsx)("li",{children:"Copy caption from caption.txt"}),(0,s.jsx)("li",{children:"Publish on Instagram"}),(0,s.jsx)("li",{children:"Mark post as published in admin with Instagram URL"})]})]}),0===e.length?(0,s.jsx)("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:(0,s.jsx)("p",{className:"text-gray-600",children:"No posts yet. Create your first post in Django Admin."})}):(0,s.jsx)("div",{className:"grid grid-cols-1 gap-6",children:e.map(e=>(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,s.jsx)("div",{className:"flex justify-between items-start mb-4",children:(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold",children:["Post #",e.id]}),(0,s.jsx)("span",{className:b(e.status),children:e.status}),(0,s.jsx)("span",{className:"text-sm text-gray-500",children:e.language.toUpperCase()})]}),(0,s.jsxs)("p",{className:"text-gray-700 mb-2",children:[e.caption.substring(0,150),e.caption.length>150?"...":""]}),e.hashtags.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:e.hashtags.map((e,a)=>(0,s.jsxs)("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:["#",e]},a))}),(0,s.jsxs)("div",{className:"flex gap-4 text-sm text-gray-600 mt-3",children:[(0,s.jsxs)("span",{children:["\uD83D\uDCF8 ",e.media_count," media"]}),(0,s.jsxs)("span",{children:["\uD83D\uDC64 ",e.created_by_username]}),(0,s.jsxs)("span",{children:["\uD83D\uDCC5 ",new Date(e.created_at).toLocaleDateString()]}),e.published_at&&(0,s.jsxs)("span",{children:["✅ Published ",new Date(e.published_at).toLocaleDateString()]})]})]})}),(0,s.jsxs)("div",{className:"flex gap-3 mt-4 pt-4 border-t",children:[e.can_generate_pack&&(0,s.jsx)("button",{onClick:()=>g(e.id),disabled:u===e.id,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50",children:u===e.id?"Generating...":"\uD83D\uDCE6 Generate Pack"}),e.pack_file_path&&(0,s.jsx)("button",{onClick:()=>x(e.id),className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"⬇️ Download Pack"}),(0,s.jsx)("a",{href:"/admin/social/instagrampost/".concat(e.id,"/change/"),className:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700",children:"✏️ Edit"}),e.instagram_url&&(0,s.jsx)("a",{href:e.instagram_url,target:"_blank",rel:"noopener noreferrer",className:"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700",children:"\uD83D\uDCF1 View on Instagram"})]}),e.pack_generated_at&&(0,s.jsx)("div",{className:"mt-4 p-3 bg-gray-50 rounded text-sm",children:(0,s.jsxs)("p",{className:"text-gray-600",children:["Pack generated: ",new Date(e.pack_generated_at).toLocaleString()]})})]},e.id))})]})})}},3227:function(e,a,t){"use strict";var s=t(3464),r=t(1290);let n="http://localhost:8000",l=s.Z.create({baseURL:n,headers:{"Content-Type":"application/json"},timeout:3e4}),i=!1,o=[],c=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;o.forEach(t=>{e?t.reject(e):t.resolve(a)}),o=[]},d=()=>{let e=window.location.pathname.split("/").filter(Boolean);return["en","es","fr","ru","uk","hy"].includes(e[0])?e[0]:"en"};l.interceptors.request.use(e=>{let a=localStorage.getItem("access_token");if(a&&e.headers&&(e.headers.Authorization="Bearer ".concat(a)),e.headers){let a=d();e.headers["Accept-Language"]=a}return e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,async e=>{var a;let t=e.config;if((null===(a=e.response)||void 0===a?void 0:a.status)===401&&!t._retry){let e=localStorage.getItem("refresh_token");if(e){if(i)return new Promise((e,a)=>{o.push({resolve:e,reject:a})}).then(e=>(t.headers&&(t.headers.Authorization="Bearer ".concat(e)),l(t))).catch(e=>Promise.reject(e));t._retry=!0,i=!0;try{let{access:a}=(await s.Z.post("".concat(n).concat(r.q.AUTH.REFRESH),{refresh:e})).data;return localStorage.setItem("access_token",a),t.headers&&(t.headers.Authorization="Bearer ".concat(a)),c(null,a),i=!1,l(t)}catch(e){c(e,null),i=!1;{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user");let e=d();window.location.href="/".concat(e,"/login")}return Promise.reject(e)}}else{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user");let e=d();window.location.href="/".concat(e,"/login")}}return Promise.reject(e)}),a.ZP=l},1290:function(e,a,t){"use strict";t.d(a,{q:function(){return s}});let s={AUTH:{TOKEN:"/api/auth/token/",REFRESH:"/api/auth/token/refresh/",ME:"/api/auth/me/"},CLINICAL:{APPOINTMENTS:"/api/v1/clinical/appointments/",PATIENTS:"/api/v1/clinical/patients/",ENCOUNTERS:"/api/v1/clinical/encounters/",TREATMENTS:"/api/v1/clinical/treatments/",PROPOSALS:"/api/v1/clinical/proposals/"},POS:{SALES:"/api/v1/pos/sales/"}}}},function(e){e.O(0,[618,586,971,117,744],function(){return e(e.s=7615)}),_N_E=e.O()}]);