(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[657],{2962:function(e,s,a){Promise.resolve().then(a.bind(a,2716))},2716:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return n}});var t=a(7437),l=a(2265),r=a(2586),i=a(3227);async function c(){return(await i.ZP.get("/ops/diagnostics")).data}function n(){(0,r.useTranslations)();let[e,s]=(0,l.useState)(null),[a,i]=(0,l.useState)(!0),[n,d]=(0,l.useState)(null),[o,m]=(0,l.useState)(null),x=async()=>{try{i(!0),d(null);let e=await c();s(e),m(new Date)}catch(s){var e,a;console.error("Error loading diagnostics:",s),d((null===(a=s.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.detail)||"Failed to load diagnostics")}finally{i(!1)}};if((0,l.useEffect)(()=>{x();let e=setInterval(x,3e4);return()=>clearInterval(e)},[]),a&&!e)return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"System Maintenance"}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:(0,t.jsx)("p",{className:"text-gray-600",children:"Loading diagnostics..."})})]})});if(n)return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"System Maintenance"}),(0,t.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[(0,t.jsx)("p",{className:"text-red-800 font-semibold",children:"Error loading diagnostics"}),(0,t.jsx)("p",{className:"text-red-600 mt-2",children:n}),(0,t.jsx)("button",{onClick:x,className:"mt-4 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700",children:"Retry"})]})]})});if(!e)return null;let h=e=>{let s="px-3 py-1 rounded-full text-sm font-semibold";return"healthy"===e||"ok"===e||"active"===e?"".concat(s," bg-green-100 text-green-800"):"degraded"===e||"warning"===e?"".concat(s," bg-yellow-100 text-yellow-800"):"".concat(s," bg-red-100 text-red-800")};return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"System Maintenance"}),o&&(0,t.jsxs)("p",{className:"text-gray-600 mt-1",children:["Last updated: ",o.toLocaleTimeString()]})]}),(0,t.jsx)("button",{onClick:x,disabled:a,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:a?"Refreshing...":"Refresh Now"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow mb-6",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Service Health"})}),(0,t.jsx)("div",{className:"p-6",children:(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:e.services.map(e=>(0,t.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsx)("h3",{className:"font-semibold",children:e.name}),(0,t.jsx)("span",{className:h(e.status),children:e.status})]}),e.details&&(0,t.jsx)("div",{className:"mt-2 text-sm text-gray-600",children:Object.entries(e.details).map(e=>{let[s,a]=e;return(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{className:"font-medium",children:[s,":"]})," ",String(a)]},s)})})]},e.name))})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Disk Space"})}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Usage"}),(0,t.jsxs)("span",{className:"font-semibold",children:[e.disk_space.percent,"%"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,t.jsx)("div",{className:"h-3 rounded-full ".concat(e.disk_space.percent>90?"bg-red-600":e.disk_space.percent>75?"bg-yellow-500":"bg-green-500"),style:{width:"".concat(e.disk_space.percent,"%")}})})]}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Total:"}),(0,t.jsx)("span",{className:"font-medium",children:e.disk_space.total})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Used:"}),(0,t.jsx)("span",{className:"font-medium",children:e.disk_space.used})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Free:"}),(0,t.jsx)("span",{className:"font-medium",children:e.disk_space.free})]})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Database Connections"})}),(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Total:"}),(0,t.jsx)("span",{className:"text-2xl font-bold",children:e.database.total_connections})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Active:"}),(0,t.jsx)("span",{className:"text-xl font-semibold text-green-600",children:e.database.active_connections})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Idle:"}),(0,t.jsx)("span",{className:"text-xl font-semibold text-gray-500",children:e.database.idle_connections})]})]})})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Redis Cache"})}),(0,t.jsxs)("div",{className:"p-6 space-y-3 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Connected Clients:"}),(0,t.jsx)("span",{className:"font-medium",children:e.redis.connected_clients})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Memory Used:"}),(0,t.jsx)("span",{className:"font-medium",children:e.redis.used_memory})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Peak Memory:"}),(0,t.jsx)("span",{className:"font-medium",children:e.redis.used_memory_peak})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Uptime:"}),(0,t.jsxs)("span",{className:"font-medium",children:[e.redis.uptime_days," days"]})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Celery Workers"})}),(0,t.jsx)("div",{className:"p-6",children:e.celery_workers.map((e,s)=>(0,t.jsxs)("div",{className:"mb-4 last:mb-0",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)("span",{className:"font-medium text-sm truncate",children:e.hostname}),(0,t.jsx)("span",{className:h(e.status),children:e.status})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Active:"})," ",(0,t.jsx)("span",{className:"font-medium",children:e.active_tasks})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Processed:"})," ",(0,t.jsx)("span",{className:"font-medium",children:e.processed_tasks})]})]})]},s))})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow mb-6",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"MinIO Storage Buckets"})}),(0,t.jsx)("div",{className:"p-6",children:(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.minio_buckets.map(e=>{var s;return(0,t.jsxs)("div",{className:"border rounded-lg p-4 ".concat(e.accessible?"border-green-200 bg-green-50":"border-red-200 bg-red-50"),children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)("h3",{className:"font-semibold",children:e.name}),(0,t.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat(e.accessible?"bg-green-200 text-green-800":"bg-red-200 text-red-800"),children:e.accessible?"Accessible":"Not Accessible"})]}),e.accessible&&(0,t.jsx)("div",{className:"text-sm text-gray-600",children:(0,t.jsxs)("p",{children:["Objects: ",null!==(s=e.object_count)&&void 0!==s?s:"N/A"]})})]},e.name)})})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Quick Actions"})}),(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("button",{className:"bg-gray-600 text-white px-4 py-3 rounded-lg hover:bg-gray-700 disabled:opacity-50",disabled:!0,children:["Clear Cache",(0,t.jsx)("p",{className:"text-xs mt-1 opacity-75",children:"Coming soon"})]}),(0,t.jsxs)("button",{className:"bg-gray-600 text-white px-4 py-3 rounded-lg hover:bg-gray-700 disabled:opacity-50",disabled:!0,children:["View Logs",(0,t.jsx)("p",{className:"text-xs mt-1 opacity-75",children:"Coming soon"})]}),(0,t.jsxs)("button",{className:"bg-gray-600 text-white px-4 py-3 rounded-lg hover:bg-gray-700 disabled:opacity-50",disabled:!0,children:["Restart Services",(0,t.jsx)("p",{className:"text-xs mt-1 opacity-75",children:"Coming soon"})]})]})})]})]})})}},3227:function(e,s,a){"use strict";var t=a(3464),l=a(1290);let r="http://localhost:8000",i=t.Z.create({baseURL:r,headers:{"Content-Type":"application/json"},timeout:3e4}),c=!1,n=[],d=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n.forEach(a=>{e?a.reject(e):a.resolve(s)}),n=[]},o=()=>{let e=window.location.pathname.split("/").filter(Boolean);return["en","es","fr","ru","uk","hy"].includes(e[0])?e[0]:"en"};i.interceptors.request.use(e=>{let s=localStorage.getItem("access_token");if(s&&e.headers&&(e.headers.Authorization="Bearer ".concat(s)),e.headers){let s=o();e.headers["Accept-Language"]=s}return e},e=>Promise.reject(e)),i.interceptors.response.use(e=>e,async e=>{var s;let a=e.config;if((null===(s=e.response)||void 0===s?void 0:s.status)===401&&!a._retry){let e=localStorage.getItem("refresh_token");if(e){if(c)return new Promise((e,s)=>{n.push({resolve:e,reject:s})}).then(e=>(a.headers&&(a.headers.Authorization="Bearer ".concat(e)),i(a))).catch(e=>Promise.reject(e));a._retry=!0,c=!0;try{let{access:s}=(await t.Z.post("".concat(r).concat(l.q.AUTH.REFRESH),{refresh:e})).data;return localStorage.setItem("access_token",s),a.headers&&(a.headers.Authorization="Bearer ".concat(s)),d(null,s),c=!1,i(a)}catch(e){d(e,null),c=!1;{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user");let e=o();window.location.href="/".concat(e,"/login")}return Promise.reject(e)}}else{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user");let e=o();window.location.href="/".concat(e,"/login")}}return Promise.reject(e)}),s.ZP=i},1290:function(e,s,a){"use strict";a.d(s,{q:function(){return t}});let t={AUTH:{TOKEN:"/api/auth/token/",REFRESH:"/api/auth/token/refresh/",ME:"/api/auth/me/"},CLINICAL:{APPOINTMENTS:"/api/v1/clinical/appointments/",PATIENTS:"/api/v1/clinical/patients/",ENCOUNTERS:"/api/v1/clinical/encounters/",TREATMENTS:"/api/v1/clinical/treatments/",PROPOSALS:"/api/v1/clinical/proposals/"},POS:{SALES:"/api/v1/pos/sales/"}}}},function(e){e.O(0,[618,586,971,117,744],function(){return e(e.s=2962)}),_N_E=e.O()}]);