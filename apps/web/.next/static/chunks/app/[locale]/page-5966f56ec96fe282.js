(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[61],{6964:function(e,t,n){Promise.resolve().then(n.bind(n,5498))},5498:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return j}});var a=n(7437),s=n(2778);function i(e){let{isLoading:t,error:n,isEmpty:s=!1,emptyMessage:i="No data available",emptyDescription:l,emptyAction:r,loadingMessage:c="Loading...",errorTitle:d,errorDescription:o,errorMessage:p,children:u}=e;return t?(0,a.jsx)("div",{className:"card",children:(0,a.jsx)("div",{className:"card-body",style:{textAlign:"center",padding:"48px 20px"},children:(0,a.jsx)("div",{style:{fontSize:"16px",color:"var(--gray-600)"},children:c})})}):n?(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"card-body",style:{textAlign:"center",padding:"48px 20px"},children:[(0,a.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px",opacity:.3},children:"⚠️"}),(0,a.jsx)("h3",{style:{fontSize:"18px",fontWeight:600,marginBottom:"8px",color:"var(--error)"},children:d||p||"Error"}),o&&(0,a.jsx)("p",{style:{color:"var(--gray-600)",fontSize:"14px",maxWidth:"400px",margin:"0 auto"},children:o})]})}):s?(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"card-body",style:{textAlign:"center",padding:"48px 20px"},children:[(0,a.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px",opacity:.3},children:"\uD83D\uDCCB"}),(0,a.jsx)("h3",{style:{fontSize:"18px",fontWeight:600,marginBottom:"8px"},children:i}),l&&(0,a.jsx)("p",{style:{color:"var(--gray-600)",marginBottom:"24px",fontSize:"14px"},children:l}),r&&(0,a.jsx)("button",{onClick:r.onClick,className:"btn-primary",disabled:!r.onClick,children:r.label})]})}):(0,a.jsx)(a.Fragment,{children:u})}var l=n(1713),r=n(9827),c=n(1770),d=n(3227),o=n(1290);let p={all:["appointments"],lists:()=>[...p.all,"list"],list:e=>[...p.lists(),e],details:()=>[...p.all,"detail"],detail:e=>[...p.details(),e]};var u=n(2265),h=n(2586),m=n(9376);function x(){return new Date().toISOString().split("T")[0]}function y(e){return!e||isNaN(new Date(e+"T00:00:00").getTime())?null:e}function g(e,t){let n=new Date(e+"T00:00:00");return n.setDate(n.getDate()+t),n.toISOString().split("T")[0]}function j(){var e;let t=(0,h.useTranslations)("agenda"),n=(0,h.useTranslations)("common"),j=(0,h.useLocale)(),v=(0,m.useRouter)(),b=(0,m.useSearchParams)(),f=(0,u.useRef)(!1),[N,S]=(0,u.useState)(()=>{let e=b.get("date");return f.current=!0,y(e)||x()}),[w,C]=(0,u.useState)(b.get("status")||"");(0,u.useEffect)(()=>{let e=new URLSearchParams;N!==x()&&e.set("date",N),w&&e.set("status",w);let t=e.toString(),n=t?"?".concat(t):"/".concat(j);window.location.pathname+window.location.search!=="/".concat(j)+(t?"?".concat(t):"")&&v.replace(n,{scroll:!1})},[N,w,j]);let{data:k,isLoading:D,error:_}=(e={date_from:N,date_to:N,status:w||void 0},(0,l.a)({queryKey:p.list(e||{}),queryFn:async()=>{try{return(await d.ZP.get(o.q.CLINICAL.APPOINTMENTS,{params:e})).data}catch(e){throw e}}})),T=function(){let e=(0,r.NL)();return(0,c.D)({mutationFn:async e=>{let{id:t,status:n}=e;return(await d.ZP.patch("".concat(o.q.CLINICAL.APPOINTMENTS).concat(t,"/"),{status:n})).data},onSuccess:(t,n)=>{e.invalidateQueries({queryKey:p.lists()}),e.invalidateQueries({queryKey:p.detail(n.id)})}})}(),P=(0,u.useMemo)(()=>(null==k?void 0:k.results)||[],[k]),I=0===P.length,z=(e,t)=>{T.mutate({id:e,status:t})};(0,u.useMemo)(()=>new Intl.DateTimeFormat(j,{year:"numeric",month:"long",day:"numeric"}),[j]);let A=(0,u.useMemo)(()=>new Intl.DateTimeFormat(j,{hour:"2-digit",minute:"2-digit"}),[j]);return(0,a.jsx)(s.Z,{children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"page-header",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{children:t("title")}),(0,a.jsx)("p",{className:"page-description",children:t("description")})]}),(0,a.jsx)("button",{onClick:()=>v.push("/".concat(j,"/schedule")),className:"btn-primary",style:{whiteSpace:"nowrap"},children:t("actions.newAppointment")})]}),(0,a.jsx)("div",{className:"card",style:{marginBottom:"16px",padding:"12px"},children:(0,a.jsxs)("div",{className:"flex gap-2",style:{alignItems:"center",flexWrap:"wrap"},children:[(0,a.jsxs)("div",{className:"flex gap-2",style:{alignItems:"center"},children:[(0,a.jsx)("button",{onClick:e=>{e.preventDefault(),S(e=>g(e,-1))},className:"btn-secondary btn-sm","aria-label":t("filters.previousDay")||"Previous day",title:t("filters.previousDay")||"Previous day",type:"button",children:"←"}),(0,a.jsx)("input",{type:"date",value:N,onChange:e=>{let t=y(e.target.value);t&&t!==N&&S(t)},className:"form-group",style:{marginBottom:0,width:"auto",padding:"8px 12px",minWidth:"160px"},"aria-label":t("filters.date")}),(0,a.jsx)("button",{onClick:e=>{e.preventDefault(),S(e=>g(e,1))},className:"btn-secondary btn-sm","aria-label":t("filters.nextDay")||"Next day",title:t("filters.nextDay")||"Next day",type:"button",children:"→"}),N!==x()&&(0,a.jsx)("button",{onClick:()=>S(x()),className:"btn-secondary btn-sm",style:{fontSize:"13px"},children:t("filters.today")||"Today"})]}),(0,a.jsxs)("select",{value:w,onChange:e=>C(e.target.value),style:{padding:"8px 12px",border:"1px solid var(--gray-300)",borderRadius:"6px"},"aria-label":t("filters.status"),children:[(0,a.jsx)("option",{value:"",children:t("filters.allStatuses")}),(0,a.jsx)("option",{value:"scheduled",children:t("appointment.status.scheduled")}),(0,a.jsx)("option",{value:"confirmed",children:t("appointment.status.confirmed")}),(0,a.jsx)("option",{value:"checked_in",children:t("appointment.status.checked_in")}),(0,a.jsx)("option",{value:"completed",children:t("appointment.status.completed")}),(0,a.jsx)("option",{value:"cancelled",children:t("appointment.status.cancelled")}),(0,a.jsx)("option",{value:"no_show",children:t("appointment.status.no_show")})]})]})}),(0,a.jsxs)(i,{isLoading:D,error:_,isEmpty:I,emptyMessage:t("emptyState.title"),emptyDescription:t("emptyState.description"),emptyAction:{label:t("emptyState.action"),onClick:void 0},loadingMessage:n("loading"),errorTitle:t("errors.title"),errorDescription:t("errors.description"),children:[(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("table",{className:"table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:t("table.time")}),(0,a.jsx)("th",{children:t("table.patient")}),(0,a.jsx)("th",{children:t("table.practitioner")}),(0,a.jsx)("th",{children:t("table.type")}),(0,a.jsx)("th",{children:t("table.status")}),(0,a.jsx)("th",{children:t("table.actions")})]})}),(0,a.jsx)("tbody",{children:P.map(e=>{var n;return(0,a.jsxs)("tr",{children:[(0,a.jsxs)("td",{children:[(0,a.jsx)("div",{style:{fontWeight:500},children:A.format(new Date(e.scheduled_start))}),e.scheduled_end&&(0,a.jsx)("div",{style:{fontSize:"12px",color:"var(--gray-600)"},children:A.format(new Date(e.scheduled_end))})]}),(0,a.jsxs)("td",{children:[(0,a.jsx)("div",{style:{fontWeight:500},children:e.patient.full_name}),(0,a.jsx)("div",{style:{fontSize:"12px",color:"var(--gray-600)"},children:e.patient.email||e.patient.phone||"—"})]}),(0,a.jsx)("td",{children:(null===(n=e.practitioner)||void 0===n?void 0:n.display_name)||"—"}),(0,a.jsx)("td",{children:(0,a.jsx)("span",{style:{fontSize:"13px",color:"var(--gray-700)"},children:e.source})}),(0,a.jsx)("td",{children:(0,a.jsx)("span",{className:"badge badge-".concat(e.status),children:t("appointment.status.".concat(e.status))})}),(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:"flex gap-2",children:["scheduled"===e.status&&(0,a.jsx)("button",{onClick:()=>z(e.id,"confirmed"),className:"btn-secondary btn-sm",disabled:T.isPending,children:t("actions.confirm")}),"confirmed"===e.status&&(0,a.jsx)("button",{onClick:()=>z(e.id,"checked_in"),className:"btn-primary btn-sm",disabled:T.isPending,children:t("actions.checkIn")}),"checked_in"===e.status&&(0,a.jsx)("button",{onClick:()=>z(e.id,"completed"),className:"btn-primary btn-sm",disabled:T.isPending,children:t("actions.complete")}),("scheduled"===e.status||"confirmed"===e.status)&&(0,a.jsx)("button",{onClick:()=>z(e.id,"cancelled"),className:"btn-secondary btn-sm",disabled:T.isPending,style:{color:"var(--error)"},children:t("actions.cancel")})]})})]},e.id)})})]})}),P.length>0&&(0,a.jsxs)("div",{style:{marginTop:"16px",fontSize:"14px",color:"var(--gray-600)"},children:[t("summary.totalAppointments"),": ",P.length]})]})]})})}}},function(e){e.O(0,[301,586,648,954,561,778,971,117,744],function(){return e(e.s=6964)}),_N_E=e.O()}]);